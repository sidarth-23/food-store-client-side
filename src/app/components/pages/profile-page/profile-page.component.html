<section>
  <div class="grid grid-cols-12 py-8">
    <section
      class="relative flex h-32 items-end bg-gray-900 col-span-12 rounded-md"
    >
      <img
        alt="Night"
        src="https://img.freepik.com/free-vector/color-doodle-food-burger-pattern_1409-3918.jpg"
        class="absolute inset-0 h-full w-full object-cover opacity-80"
      />
    </section>
    <section
      class="flex justify-center items-center px-8 col-span-12 lg:justify-start pt-6"
    >
      <div class="w-full">
        <h1
          class="mt-2 text-2xl font-bold text-gray-200 sm:text-3xl md:text-4xl border-b-2 border-white"
        >
          About You
        </h1>
        <div class="flex gap-10 justify-center">
          <a
            routerLink="/profile/user"
            routerLinkActive="text-primary-red bg-transparent"
            class="inline-block shrink-0 rounded-md border border-primary-red bg-primary-red px-12 py-3 text-sm font-medium text-white transition hover:bg-transparent hover:text-primary-red focus:outline-none focus:ring"
          >
            Set User Details
          </a>
          <a
            routerLink="/profile/password"
            routerLinkActive="text-primary-red bg-transparent"
            class="inline-block shrink-0 rounded-md border border-primary-red bg-primary-red px-12 py-3 text-sm font-medium text-white transition hover:bg-transparent hover:text-primary-red focus:outline-none focus:ring"
          >
            Set Password
          </a>
        </div>
      </div>
    </section>
    @if (updateSection === 'user') {
    <div class="col-span-12 flex justify-center items-center sm:gap-4 pt-6">
      <button
        class="w-10/12 inline-block shrink-0 rounded-md border border-primary-red hover:bg-primary-red px-12 py-3 text-sm font-medium text-primary-red transition hover:bg-transparent hover:text-white focus:outline-none focus:ring active:text-blue-500"
        (click)="enableFormClick()"
      >
        {{ enableForm ? "Disable Edit" : "Enable Edit" }}
      </button>
    </div>
    <div class="col-span-12 flex justify-center items-center px-10 lg:px-3">
      <div class="grid grid-cols-2 col-span-12">
        <main
          class="flex justify-center px-4 py-8 lg:px-12 col-span-2 lg:col-span-1 w-full"
          [@fadeInOut]="initiation"
        >
          <div class="w-full lg:max-w-3xl">
            <div class="block min-h-6 border-b-[1px] border-slate-300">
              <div class="inline-flex items-center">
                <label
                  class="relative flex items-center p-3 rounded-full cursor-pointer"
                  htmlFor="check"
                >
                  <input
                    type="checkbox"
                    class="before:content[''] peer relative h-5 w-5 cursor-pointer appearance-none rounded-md border border-blue-gray-200 transition-all before:absolute before:top-2/4 before:left-2/4 before:block before:h-12 before:w-12 before:-translate-y-2/4 before:-translate-x-2/4 before:rounded-full before:bg-blue-gray-500 before:opacity-0 before:transition-opacity checked:border-gray-900 checked:bg-gray-900 checked:before:bg-gray-900 hover:before:opacity-10"
                    id="check"
                    [checked]="checkAddressEdit"
                    (change)="checkAddressEdit = !checkAddressEdit"
                  />
                  <span
                    class="absolute text-white transition-opacity opacity-0 pointer-events-none top-2/4 left-2/4 -translate-y-2/4 -translate-x-2/4 peer-checked:opacity-100"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="h-3.5 w-3.5"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      stroke="currentColor"
                      stroke-width="1"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                        clip-rule="evenodd"
                      ></path>
                    </svg>
                  </span>
                </label>
                <label
                  class="mt-px font-light text-slate-300 cursor-pointer select-none"
                  htmlFor="check"
                >
                  Edit address with changes on map location
                </label>
              </div>
            </div>
            <form
              [formGroup]="updateUserForm"
              class="mt-8 grid grid-cols-6 gap-6"
              (ngSubmit)="onSubmit()"
            >
              <div class="col-span-6">
                <app-text-input-box
                  [type]="'text'"
                  [label]="'First Name'"
                  [minlength]="3"
                  [control]="formControlUser('firstName')"
                  [withInfoIcon]="true"
                  [errorCategories]="nameErrorArray"
                ></app-text-input-box>
              </div>

              <div class="col-span-6">
                <app-text-input-box
                  [type]="'text'"
                  [label]="'Last Name'"
                  [control]="formControlUser('lastName')"
                ></app-text-input-box>
              </div>

              <div class="col-span-6">
                <app-text-input-box
                  [type]="'text'"
                  [label]="'Address Line 1'"
                  [control]="formControlUser('addressLine1')"
                  [withInfoIcon]="true"
                  [minlength]="3"
                  [errorCategories]="addressErrorArray"
                ></app-text-input-box>
              </div>

              <div class="col-span-6">
                <app-text-input-box
                  [type]="'text'"
                  [label]="'Address Line 2'"
                  [control]="formControlUser('addressLine2')"
                ></app-text-input-box>
              </div>

              <div class="col-span-6 sm:col-span-3">
                <div>
                  <label
                    for="CitySelect"
                    class="block text-sm font-medium text-neutral-300 after:content-['*'] after:text-red-400"
                  >
                    City
                  </label>

                  <select
                    name="HeadlineAct"
                    id="CitySelect"
                    class="scrollbar-thin scrollbar-track-slate-700 scrollbar-thumb-slate-300 mt-1.5 w-full rounded-lg bg-black border-gray-300 text-neutral-300 sm:text-sm disabled:border-none"
                    formControlName="city"
                  >
                    @if (tempCities === [] && tempStates !== []) {
                    <option class="bg-black text-white" value="">
                      Ignore asterix
                    </option>
                    } @else { @for (item of tempCities; track item) {
                    <option class="bg-black text-white" [value]="item.trim()">
                      {{ item }}
                    </option>
                    } }
                  </select>
                </div>
              </div>

              <div class="col-span-6 sm:col-span-3">
                <div>
                  <label
                    for="StateSelect"
                    class="block text-sm font-medium text-neutral-300 after:content-['*'] after:text-red-400"
                  >
                    State
                  </label>

                  <select
                    name="HeadlineAct"
                    id="StateSelect"
                    class="scrollbar-thin scrollbar-track-slate-700 scrollbar-thumb-slate-300 mt-1.5 w-full rounded-lg bg-black border-gray-300 text-neutral-300 sm:text-sm disabled:border-none"
                    (change)="onStateChange()"
                    formControlName="state"
                  >
                    @if (tempStates === []) {
                    <option class="bg-black text-white" value="">
                      Service Unavailable
                    </option>
                    } @for (item of tempStates; track item) {
                    <option class="bg-black text-white" [value]="item.trim()">
                      {{ item }}
                    </option>
                    }
                  </select>
                </div>
              </div>

              <div class="col-span-6 sm:col-span-3">
                <app-text-input-box
                  [type]="'text'"
                  [label]="'Zip Code'"
                  [control]="formControlUser('zipCode')"
                ></app-text-input-box>
              </div>

              <div class="col-span-6 sm:col-span-3">
                <div>
                  <label
                    for="HeadlineAct"
                    class="block text-sm font-medium text-neutral-300 after:content-['*'] after:text-red-400"
                  >
                    Country
                  </label>

                  <select
                    name="HeadlineAct"
                    id="HeadlineAct"
                    class="scrollbar-thin scrollbar-track-slate-700 scrollbar-thumb-slate-300 mt-1.5 w-full rounded-lg bg-black border-gray-300 text-neutral-300 sm:text-sm disabled:border-none"
                    (change)="onCountryChange()"
                    formControlName="country"
                  >
                    @for (item of tempCountries; track item) {
                    <option class="bg-black text-white" [value]="item.trim()">
                      {{ item }}
                    </option>
                    }
                  </select>
                </div>
              </div>
              @if (enableForm) {
              <div class="col-span-6 hidden lg:flex lg:items-center lg:gap-4">
                <div class="col-span-6 sm:flex sm:items-center sm:gap-4 w-full">
                  <button
                    type="submit"
                    class="w-full inline-block shrink-0 rounded-md border border-primary-red hover:bg-primary-red px-12 py-3 text-sm font-medium text-primary-red transition hover:bg-transparent hover:text-white focus:outline-none focus:ring"
                    [disabled]="!updateUserForm.valid"
                  >
                    Update Profile
                  </button>
                </div>
              </div>
              }
            </form>
          </div>
        </main>
        @defer (when userData) { @if (enableForm) {
        <div
          class="px-8 py-8 col-span-2 lg:col-span-1"
          [@fadeInOut]="enableForm"
        >
          <app-maps
            (locationClicked)="onMapClick($event)"
            [address]="userData.data.Address"
          ></app-maps>
        </div>
        } }

        <div class="px-8 py-8 lg:hidden col-span-2 grid gap-4">
          @if (enableForm) {
          <div class="col-span-6 sm:flex sm:items-center sm:gap-4">
            <div class="col-span-6 sm:flex sm:items-center sm:gap-4 w-full">
              <button
                class="w-full inline-block shrink-0 rounded-md border border-primary-red hover:bg-primary-red px-12 py-3 text-sm font-medium text-primary-red transition hover:bg-transparent hover:text-white focus:outline-none focus:ring"
                (click)="onSubmit()"
                [disabled]="!updateUserForm.valid"
              >
                Update Profile
              </button>
            </div>
          </div>
          }
        </div>
      </div>
    </div>
    } @else if (updateSection === 'password') {
    <main class="flex justify-center items-center px-8 col-span-12 pt-6">
      <div class="w-full flex justify-center">
        <form
          [@fadeInOut]="updateSection"
          class="w-full mt-8 grid grid-cols-6 gap-6 max-w-xl"
          [formGroup]="updatePasswordForm"
          (ngSubmit)="onPasswordSubmit()"
        >
          <div class="col-span-6">
            <app-text-input-box
              [type]="'password'"
              [label]="'Password'"
              [control]="formControlPass('password')"
              [withInfoIcon]="true"
              [minlength]="8"
              [errorCategories]="passwordErrorArray"
            ></app-text-input-box>
          </div>

          <div class="col-span-6">
            <app-text-input-box
              [type]="'password'"
              [label]="'Confirm Password'"
              [control]="formControlPass('confirmPassword')"
            ></app-text-input-box>
          </div>

          <div class="col-span-6 sm:flex sm:items-center sm:gap-4">
            <button
              class="transition-colors w-full inline-block shrink-0 rounded-md border border-primary-red hover:bg-primary-red px-12 py-3 text-sm font-medium text-primary-red bg-transparent hover:text-white focus:outline-none focus:ring disabled:border-none disabled:bg-slate-600 disabled:text-slate-100"
              type="submit"
              [disabled]="!updatePasswordForm.valid"
            >
              Update Password
            </button>
          </div>
        </form>
      </div>
    </main>
    }
  </div>
</section>
